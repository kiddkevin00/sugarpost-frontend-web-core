'use strict';

/**
 * The process of the web application begins here - non-cluster mode.
 */

process.env.NODE_ENV = process.env.NODE_ENV || 'development';

if (process.env.NODE_ENV !== 'production') {
  require('babel-register');
}

var setupExpressServer = require('./express-server');
var setupRoutes = require('./routes');
var packageJson = require('../../../package.json');
var express = require('express');
var http = require('http');

var app = express();
var server = http.createServer(app);

setupExpressServer(app);
setupRoutes(app);

var ip = process.env.IP || packageJson.config.ip;
var port = process.env.PORT || packageJson.config.port;

var webServer = server.listen(port, ip, function () {
  // [TODO] Replaces `console.log()` with a logger module.
  console.log('Express server listening on port: %d at IP: %s, in %s mode.', webServer.address().port, webServer.address().address, app.get('env'));
});

// [TODO] Cleans up whenever the app crashes.
process.on('uncaughtException', function () {});
// [TODO] Cleans up whenever getting a default kill signal.
process.on('SIGTERM', function () {});

module.exports = exports = app;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvc2VydmVyL2FwcC5qcyJdLCJuYW1lcyI6WyJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJyZXF1aXJlIiwic2V0dXBFeHByZXNzU2VydmVyIiwic2V0dXBSb3V0ZXMiLCJwYWNrYWdlSnNvbiIsImV4cHJlc3MiLCJodHRwIiwiYXBwIiwic2VydmVyIiwiY3JlYXRlU2VydmVyIiwiaXAiLCJJUCIsImNvbmZpZyIsInBvcnQiLCJQT1JUIiwid2ViU2VydmVyIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyIsImFkZHJlc3MiLCJnZXQiLCJvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFJQUEsUUFBUUMsR0FBUixDQUFZQyxRQUFaLEdBQXVCRixRQUFRQyxHQUFSLENBQVlDLFFBQVosSUFBd0IsYUFBL0M7O0FBRUEsSUFBSUYsUUFBUUMsR0FBUixDQUFZQyxRQUFaLEtBQXlCLFlBQTdCLEVBQTJDO0FBQ3pDQyxVQUFRLGdCQUFSO0FBQ0Q7O0FBRUQsSUFBTUMscUJBQXFCRCxRQUFRLGtCQUFSLENBQTNCO0FBQ0EsSUFBTUUsY0FBY0YsUUFBUSxVQUFSLENBQXBCO0FBQ0EsSUFBTUcsY0FBY0gsUUFBUSx1QkFBUixDQUFwQjtBQUNBLElBQU1JLFVBQVVKLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1LLE9BQU9MLFFBQVEsTUFBUixDQUFiOztBQUVBLElBQU1NLE1BQU1GLFNBQVo7QUFDQSxJQUFNRyxTQUFTRixLQUFLRyxZQUFMLENBQWtCRixHQUFsQixDQUFmOztBQUVBTCxtQkFBbUJLLEdBQW5CO0FBQ0FKLFlBQVlJLEdBQVo7O0FBRUEsSUFBTUcsS0FBS1osUUFBUUMsR0FBUixDQUFZWSxFQUFaLElBQW1CUCxZQUFZUSxNQUFaLENBQW1CRixFQUFqRDtBQUNBLElBQU1HLE9BQU9mLFFBQVFDLEdBQVIsQ0FBWWUsSUFBWixJQUFvQlYsWUFBWVEsTUFBWixDQUFtQkMsSUFBcEQ7O0FBRUEsSUFBTUUsWUFBWVAsT0FBT1EsTUFBUCxDQUFjSCxJQUFkLEVBQW9CSCxFQUFwQixFQUF3QixZQUFNO0FBQzlDO0FBQ0FPLFVBQVFDLEdBQVIsQ0FBWSw2REFBWixFQUNFSCxVQUFVSSxPQUFWLEdBQW9CTixJQUR0QixFQUVFRSxVQUFVSSxPQUFWLEdBQW9CQSxPQUZ0QixFQUUrQlosSUFBSWEsR0FBSixDQUFRLEtBQVIsQ0FGL0I7QUFHRCxDQUxpQixDQUFsQjs7QUFPQTtBQUNBdEIsUUFBUXVCLEVBQVIsQ0FBVyxtQkFBWCxFQUFnQyxZQUFNLENBRXJDLENBRkQ7QUFHQTtBQUNBdkIsUUFBUXVCLEVBQVIsQ0FBVyxTQUFYLEVBQXNCLFlBQU0sQ0FFM0IsQ0FGRDs7QUFJQUMsT0FBT0MsT0FBUCxHQUFpQkEsVUFBVWhCLEdBQTNCIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhlIHByb2Nlc3Mgb2YgdGhlIHdlYiBhcHBsaWNhdGlvbiBiZWdpbnMgaGVyZSAtIG5vbi1jbHVzdGVyIG1vZGUuXG4gKi9cblxucHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAnZGV2ZWxvcG1lbnQnO1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICByZXF1aXJlKCdiYWJlbC1yZWdpc3RlcicpO1xufVxuXG5jb25zdCBzZXR1cEV4cHJlc3NTZXJ2ZXIgPSByZXF1aXJlKCcuL2V4cHJlc3Mtc2VydmVyJyk7XG5jb25zdCBzZXR1cFJvdXRlcyA9IHJlcXVpcmUoJy4vcm91dGVzJyk7XG5jb25zdCBwYWNrYWdlSnNvbiA9IHJlcXVpcmUoJy4uLy4uLy4uL3BhY2thZ2UuanNvbicpO1xuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbmNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XG5cbnNldHVwRXhwcmVzc1NlcnZlcihhcHApO1xuc2V0dXBSb3V0ZXMoYXBwKTtcblxuY29uc3QgaXAgPSBwcm9jZXNzLmVudi5JUCAgfHwgcGFja2FnZUpzb24uY29uZmlnLmlwO1xuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgcGFja2FnZUpzb24uY29uZmlnLnBvcnQ7XG5cbmNvbnN0IHdlYlNlcnZlciA9IHNlcnZlci5saXN0ZW4ocG9ydCwgaXAsICgpID0+IHtcbiAgLy8gW1RPRE9dIFJlcGxhY2VzIGBjb25zb2xlLmxvZygpYCB3aXRoIGEgbG9nZ2VyIG1vZHVsZS5cbiAgY29uc29sZS5sb2coJ0V4cHJlc3Mgc2VydmVyIGxpc3RlbmluZyBvbiBwb3J0OiAlZCBhdCBJUDogJXMsIGluICVzIG1vZGUuJyxcbiAgICB3ZWJTZXJ2ZXIuYWRkcmVzcygpLnBvcnQsXG4gICAgd2ViU2VydmVyLmFkZHJlc3MoKS5hZGRyZXNzLCBhcHAuZ2V0KCdlbnYnKSk7XG59KTtcblxuLy8gW1RPRE9dIENsZWFucyB1cCB3aGVuZXZlciB0aGUgYXBwIGNyYXNoZXMuXG5wcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsICgpID0+IHtcblxufSk7XG4vLyBbVE9ET10gQ2xlYW5zIHVwIHdoZW5ldmVyIGdldHRpbmcgYSBkZWZhdWx0IGtpbGwgc2lnbmFsLlxucHJvY2Vzcy5vbignU0lHVEVSTScsICgpID0+IHtcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cyA9IGFwcDtcbiJdfQ==
//# sourceMappingURL=app.js.map
